\chapter{Аналитический раздел}
\label{cha:analysis}
%
% % В начале раздела  можно напомнить его цель
%
% В данном разделе анализируется и классифицируется существующая всячина и пути создания новой всячины. А вот отступ справа в 1 см. "--- это хоть и по ГОСТ, но ведь диагноз же...

\section{Природа размытия движения}

\subsection{Причины появления смаза}

Причины возникновения размытия изображений при съёмке камерой связаны со способом захвата изображения. Свет попадает на светочувствительную матрицу устройства. Затвор и диафрагма влияют на количество света, попавшего на матрицу. Затвор ограничивает время, в течение которого свет попадает на матрицу и формируется итоговое изображение. Данное время называется выдержкой.
\par
После открытия затвора матрица начинает аккумулировать весь свет, попавший на неё. Так как во время движения объекта отраженные лучи света меняют своё положения, то во время выдержки все проекции объекта на плоскость матрицы будут запечатлены на итоговом изображении.    
\par
Данный процесс выдержки может быть формализован с помощью уравнения \eqref{F:F2_1_1} . Во время съемки сцены,  представляет собой содержимое плоскости изображения. Захваченный свет является результатом аккумулирования входящего излучения $L$ в течение времени выдержки $\Delta T$. Функция $f$ моделирует влияние оптики, затвора, диафрагмы и пленки.
\par
\begin{equation}
    I = \int_{\Delta T} f(t) \cdot L(t) dt
    \label{F:F2_1_1}
\end{equation}
\par
Уравнение \eqref{F:F2_1_1} дает представления о характеристиках получаемых изображений. \cite{Navarro11}

\subsection{Описание характеристик смаза}

Выдвинем следующие требования для генерации смазывания движущихся объектов:

\begin{enumerate}
    \item Смазывание должно быть вдоль вектора движения объекта
    \item Продолжительность смаза должна зависеть от скорости движения объекта
    \item Объекты без движения не подвергаются смазыванию
    \item Смаз не терпит разрывов
    \item Смаз не влияет на интенсивность изображения
\end{enumerate}

\section{Методы размытия движения}

\subsection{Размытие движения с помощью накопительного буфера}

Одним из первых решений, которое можно предложить - это склеивание нескольких отрендеренных изображений.
Заметим, что интенсивность изображения должна оставаться без изменений. Тогда получим следующую формулу.


\begin{eqndesc}
    \begin{equation}\label{F:F202}
        I(t, x, y) = \frac{ \sum_{i=0}^{N} {f(\frac{i}{N}) \cdot V_{t- \frac{i}{N} \cdot \Delta T}[x,y] }}
        {\sum_{i=0}^{N} {f(\frac{i}{N}) }}
    \end{equation}
    \\
    где $t - \frac{i}{N} \cdot \Delta T$ "--- момент времени в интервале $[t-\Delta T; t]$,\\
    $f$ "--- функция задающая интенсивность каждого кадра, в определенный момент времени,\\
    $V_t$ "--- Буфер со сгенерированным изображением в момент времени $t$\\
    $I(t,x,y)$ "--- Пиксель $[x,y]$ финального изображения в момент времени $t$
\end{eqndesc}

Для достижения наивысшей скорости отрисовки изображения при генерации видео ряда необходимо хранить результаты последних $N$ кадров. Так как шаг $\Delta T$ и частота обновления экрана $fps$ постоянны, то можно переиспользовать кадры предыдущих итераций. Тогда на каждом новом этапе необходимо отрисовать следущее количество новых кадров  $k = \frac{N}{fps \cdot \Delta T}$, $k \in Z$
\\
Достигается максимальная скорость работы алгоритма при $k = 1$, т.е. когда $fps = \frac{N}{\Delta T}$
Такое решение не строит дополнительные кадры, а берет только $N$ последних отрендеренных кадров, хорошего качества можно добиться только при $N > 32, \Delta T \in [0; 1]$.

\begin{table}[ht]
    \caption{Зависимость частоты кадров от качества и продолжительности размытия движения}
    \begin{tabular}{|r|c|c|c|l|}
        \hline
        $\Delta T$, c  & $N =8$ & $=16$ & $=32$ & $=64$ \\
        \hline
        $1$            & 8      & 16    & 32    & 64    \\
        $\frac{1}{2}$  & 16     & 32    & 64    & 128   \\
        $\frac{1}{4}$  & 32     & 64    & 128   & 256   \\
        $\frac{1}{8}$  & 64     & 128   & 256   & 512   \\
        $\frac{1}{16}$ & 128    & 256   & 512   & 1024  \\
        \hline
    \end{tabular}
    \label{tab:tabular}
\end{table}


Чтобы получить изображение с низкой выдержкой при большом кол-ве семплов нужно иметь большой fps, что становится преградой для реализации размытия в режиме реального времени.

\subsection{Размытие движения с помощью скорости пикселя}

Здесь по статье GPU Gems 3 Nvidea

\subsection{Размытие движения с помощью максимальной скорости движения участка изображения и буфера глубины}

\subsection{Сравнение методов размытия движения}




\section{Удаление невидимых линий и поверхностей}

\subsection{Алгоритм плавающего горизонта}

\subsection{Алгоритм Робертса}

\subsection{Алгоритм Варнока}

\subsection{Алгоритм, использующий список приоритетов}

\subsection{Алгоритм, использующий z-буфер}

\subsection{Алгоритм определения видимых поверхностей путем трассировки лучей}

\subsection{Сравнение алгоритмов удаления невидимых линий и поверхностей}




% Обратите внимание, что включается не ../dia/..., а inc/dia/...
% В Makefile есть соответствующее правило для inc/dia/*.pdf, которое
% берет исходные файлы из ../dia в этом случае.

% \begin{figure}
%   \centering
%   \includegraphics[width=\textwidth]{inc/dia/rpz-idef0}
%   \caption{Рисунок}
%   \label{fig:fig01}
% \end{figure}

% \begin{figure}
%   \centering
%   \includegraphics[height=0.85\textheight]{inc/img/leonardo}
%   \caption{Предполагаемый автопортрет Леонардо да Винчи}
%   \label{fig:leonardo}
% \end{figure}

% В \cite{Pup09} указано, что...

% Кстати, про картинки. Во-первых, для фигур следует использовать \texttt{[ht]}. Если и после этого картинки вставляются <<не по ГОСТ>>, т.е. слишком далеко от места ссылки, "--- значит у вас в РПЗ \textbf{слишком мало текста}! Хотя и ужасный параметр \texttt{!ht} у окружения \texttt{figure} тоже никто не отменял, только при его использовании документ получается страшный, как в ворде, поэтому просьба так не делать по возможности.

% \section{Существующие подходы к созданию всячины}

% Известны следующие подходы...

% \begin{enumerate}
% \item Перечисление с номерами.
% \item Номера первого уровня. Да, ГОСТ требует именно так "--- сначала буквы, на втором уровне "--- цифры.
% Чуть ниже будет вариант <<нормальной>> нумерации и советы по её изменению.
% Да, мне так нравится: на первом уровне выравнивание элементов как у обычных абзацев. Проверим теперь вложенные списки.
% \begin{enumerate}
% \item Номера второго уровня.
% \item Номера второго уровня. Проверяем на длииииной-предлиииииииииинной строке, что получается.... Сойдёт.
% \end{enumerate}
% \item По мнению Лукьяненко, человеческий мозг старается подвести любую проблему к выбору
%   из трех вариантов.
% \item Четвёртый (и последний) элемент списка.
% \end{enumerate}

% Теперь мы покажем, как изменить нумерацию на «нормальную», если вам этого захочется. Пара команд в начале документа поможет нам.

% \renewcommand{\labelenumi}{\arabic{enumi})}
% \renewcommand{\labelenumii}{\asbuk{enumii})}

% \begin{enumerate}
% \item Изменим нумерацию на более привычную...
% \item ... нарушим этим гост.
% \begin{enumerate}
% \item Но, пожалуй, так лучше.
% \end{enumerate}
% \end{enumerate}

% В заключение покажем произвольные маркеры в списках. Для них нужен пакет \textbf{enumerate}.
% \begin{enumerate}[1.]
% \item Маркер с арабской цифрой и с точкой.
% \item Маркер с арабской цифрой и с точкой.
% \begin{enumerate}[I.]
% \item Римская цифра с точкой.
% \item Римская цифра с точкой.
% \end{enumerate}
% \end{enumerate}

% В отчётах могут быть и таблицы "--- см. табл.~\ref{tab:tabular} и~\ref{tab:longtable}.
% Небольшая таблица делается при помощи \Code{tabular} внутри \Code{table} (последний
% полностью аналогичен \Code{figure}, но добавляет другую подпись).

% \begin{table}[ht]
%   \caption{Пример короткой таблицы с коротким названием}
%   \begin{tabular}{|r|c|c|c|l|}
%   \hline
%   Тело      & $F$ & $V$  & $E$ & $F+V-E-2$ \\
%   \hline
%   Тетраэдр  & 4   & 4    & 6   & 0         \\
%   Куб       & 6   & 8    & 12  & 0         \\
%   Октаэдр   & 8   & 6    & 12  & 0         \\
%   Додекаэдр & 20  & 12   & 30  & 0         \\
%   Икосаэдр  & 12  & 20   & 30  & 0         \\
%   \hline
%   Эйлер     & 666 & 9000 & 42  & $+\infty$ \\
%   \hline
%   \end{tabular}
%   \label{tab:tabular}
% \end{table}

% Для больших таблиц следует использовать пакет \Code{longtable}, позволяющий создавать
% таблицы на несколько страниц по ГОСТ.

% Для того, чтобы длинный текст разбивался на много строк в пределах одной ячейки, надо в
% качестве ее формата задавать \texttt{p} и указывать явно ширину: в мм/дюймах
% (\texttt{110mm}), относительно ширины страницы (\texttt{0.22\textbackslash textwidth})
% и~т.п.

% Можно также использовать уменьшенный шрифт "--- но, пожалуйста, тогда уж во \textbf{всей}
% таблице сразу.

% \begin{center}
%   \begin{longtable}{|p{0.40\textwidth}|c|p{0.30\textwidth}|}
%     \caption{Пример длинной таблицы с длинным названием на много длинных-длинных строк}
%     \label{tab:longtable}
%     \\ \hline
%     Вид шума & Громкость, дБ & Комментарий \\
%     \hline \endfirsthead
%     \subcaption{Продолжение таблицы~\ref{tab:longtable}}
%     \\ \hline \endhead
%     \hline \subcaption{Продолжение на след. стр.}
%     \endfoot
%     \hline \endlastfoot
%     Порог слышимости             & 0     &                                                \\
%     \hline
%     Шепот в тихой библиотеке     & 30    &                                                \\
%     Обычный разговор             & 60-70 &                                                \\
%     Звонок телефона              & 80    & \small{Конечно, это было до эпохи мобильников} \\
%     Уличный шум                  & 85    & \small{(внутри машины)}                        \\
%     Гудок поезда                 & 90    &                                                \\
%     Шум электрички               & 95    &                                                \\
%     \hline
%     Порог здоровой нормы         & 90-95 & \small{Длительное пребывание на более
%     громком шуме может привести к ухудшению слуха}                                        \\
%     \hline
%     Мотоцикл                     & 100   &                                                \\
%     Power Mower                  & 107   & \small{(модель бензокосилки)}                  \\
%     Бензопила                    & 110   & \small{(Doom в целом вреден для здоровья)}     \\
%     Рок-концерт                  & 115   &                                                \\
%     \hline
%     Порог боли                   & 125   & \small{feel the pain}                          \\
%     \hline
%     Клепальный молоток           & 125   & \small{(автор сам не знает, что это)}          \\
%     \hline
%     Порог опасности              & 140   & \small{Даже кратковременное пребывание на
%     шуме большего уровня может привести к необратимым последствиям}                       \\
%     \hline
%     Реактивный двигатель         & 140   &                                                \\
%                                  & 180   & \small{Необратимое полное повреждение
%                                  слуховых органов}                                        \\
%     Самый громкий возможный звук & 194   & \small{Интересно, почему?..}                   \\
%   \end{longtable}
% \end{center}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "rpz"
%%% End:
